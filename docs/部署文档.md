# æ¡Œé¢çµå®  - éƒ¨ç½²æ–‡æ¡£

## ğŸ“¦ æ‰“åŒ…æ–¹æ³•

### æ–¹æ³•1ï¼šPyInstallerï¼ˆæ¨èï¼‰

#### æ­¥éª¤1ï¼šå®‰è£… PyInstaller
```bash
pip install pyinstaller
```

#### æ­¥éª¤2ï¼šæ‰“åŒ…

**é€‰é¡¹Aï¼šå•æ–‡ä»¶æ‰“åŒ…ï¼ˆæ¨èï¼Œæ–¹ä¾¿åˆ†å‘ï¼‰**
```bash
pyinstaller --onefile --windowed --icon=assets/icons/tray_icon.ico --name="æ¡Œé¢çµå® " main.py
```

**é€‰é¡¹Bï¼šæ–‡ä»¶å¤¹æ‰“åŒ…ï¼ˆå¯åŠ¨æ›´å¿«ï¼‰**
```bash
pyinstaller --windowed --icon=assets/icons/tray_icon.ico --name="æ¡Œé¢çµå® " main.py
```

#### æ­¥éª¤3ï¼šå¤åˆ¶èµ„æºæ–‡ä»¶

æ‰“åŒ…å®Œæˆåï¼Œéœ€è¦å°†ä»¥ä¸‹æ–‡ä»¶å¤¹å¤åˆ¶åˆ° `dist` ç›®å½•ï¼š
```
dist/
â”œâ”€â”€ æ¡Œé¢çµå® .exe
â”œâ”€â”€ assets/          # å¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹
â”œâ”€â”€ config.ini       # å¤åˆ¶é…ç½®æ–‡ä»¶
â””â”€â”€ data/            # åˆ›å»ºæ•°æ®ç›®å½•
```

---

## ğŸ”§ è¯¦ç»†é…ç½®

### ä½¿ç”¨ spec æ–‡ä»¶ï¼ˆæ¨èï¼‰

åˆ›å»ºæ‰“åŒ…é…ç½®æ–‡ä»¶ï¼Œæ›´çµæ´»æ§åˆ¶æ‰“åŒ…è¿‡ç¨‹ã€‚

**æ­¥éª¤1ï¼šç”Ÿæˆ spec æ–‡ä»¶**
```bash
pyi-makespec --onefile --windowed --icon=assets/icons/tray_icon.ico --name="æ¡Œé¢çµå® " main.py
```

**æ­¥éª¤2ï¼šç¼–è¾‘ spec æ–‡ä»¶**

ç”Ÿæˆçš„ `æ¡Œé¢çµå® .spec` æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š

```python
# -*- mode: python ; coding: utf-8 -*-

block_cipher = None

# æ·»åŠ èµ„æºæ–‡ä»¶
added_files = [
    ('assets', 'assets'),           # åŒ…å«æ‰€æœ‰èµ„æºæ–‡ä»¶
    ('config.ini', '.'),            # é…ç½®æ–‡ä»¶
    ('src', 'src'),                 # æºä»£ç ï¼ˆå¦‚æœéœ€è¦ï¼‰
]

a = Analysis(
    ['main.py'],
    pathex=[],
    binaries=[],
    datas=added_files,              # æ·»åŠ æ•°æ®æ–‡ä»¶
    hiddenimports=[],
    hookspath=[],
    hooksconfig={},
    runtime_hooks=[],
    excludes=[],
    win_no_prefer_redirects=False,
    win_private_assemblies=False,
    cipher=block_cipher,
    noarchive=False,
)

pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher)

exe = EXE(
    pyz,
    a.scripts,
    a.binaries,
    a.zipfiles,
    a.datas,
    [],
    name='æ¡Œé¢çµå® ',
    debug=False,
    bootloader_ignore_signals=False,
    strip=False,
    upx=True,
    upx_exclude=[],
    runtime_tmpdir=None,
    console=False,                  # ä¸æ˜¾ç¤ºæ§åˆ¶å°çª—å£
    disable_windowed_traceback=False,
    argv_emulation=False,
    target_arch=None,
    codesign_identity=None,
    entitlements_file=None,
    icon='assets/icons/tray_icon.ico',  # åº”ç”¨å›¾æ ‡
)
```

**æ­¥éª¤3ï¼šä½¿ç”¨ spec æ–‡ä»¶æ‰“åŒ…**
```bash
pyinstaller æ¡Œé¢çµå® .spec
```

---

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šæ‰“åŒ…åæ— æ³•æ‰¾åˆ°èµ„æºæ–‡ä»¶

**åŸå› **ï¼šèµ„æºæ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®

**è§£å†³æ–¹æ³•**ï¼šä¿®æ”¹ä»£ç ä¸­çš„èµ„æºè·¯å¾„

```python
# åœ¨ main.py æˆ–ç›¸å…³æ–‡ä»¶å¼€å¤´æ·»åŠ 
import sys
import os

def get_resource_path(relative_path):
    """è·å–èµ„æºæ–‡ä»¶çš„ç»å¯¹è·¯å¾„"""
    if hasattr(sys, '_MEIPASS'):
        # PyInstaller åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶å¤¹
        return os.path.join(sys._MEIPASS, relative_path)
    return os.path.join(os.path.abspath("."), relative_path)

# ä½¿ç”¨æ–¹æ³•
icon_path = get_resource_path("assets/icons/tray_icon.png")
```

### é—®é¢˜2ï¼šæ‰“åŒ…æ–‡ä»¶å¤ªå¤§

**è§£å†³æ–¹æ³•**ï¼š

1. ä½¿ç”¨ UPX å‹ç¼©ï¼ˆéœ€è¦ä¸‹è½½ UPXï¼‰
```bash
pyinstaller --onefile --windowed --upx-dir=./upx main.py
```

2. æ’é™¤ä¸éœ€è¦çš„åº“
```bash
pyinstaller --onefile --windowed --exclude-module=matplotlib main.py
```

### é—®é¢˜3ï¼šæ‰“åŒ…åè¿è¡ŒæŠ¥é”™

**è§£å†³æ–¹æ³•**ï¼š

1. å…ˆç”¨é `--windowed` æ¨¡å¼æ‰“åŒ…ï¼ŒæŸ¥çœ‹æ§åˆ¶å°é”™è¯¯
```bash
pyinstaller --onefile main.py
```

2. æ·»åŠ éšè—å¯¼å…¥
```bash
pyinstaller --onefile --hidden-import=PyQt5 main.py
```

### é—®é¢˜4ï¼šä¸­æ–‡è·¯å¾„é—®é¢˜

**è§£å†³æ–¹æ³•**ï¼š

ç¡®ä¿ä»£ç ä½¿ç”¨ UTF-8 ç¼–ç ï¼Œåœ¨æ–‡ä»¶å¼€å¤´æ·»åŠ ï¼š
```python
# -*- coding: utf-8 -*-
```

---

## ğŸ“¦ å‘å¸ƒå‡†å¤‡

### åˆ›å»ºå‘å¸ƒåŒ…

```
æ¡Œé¢çµå® _v1.0/
â”œâ”€â”€ æ¡Œé¢çµå® .exe           # å¯æ‰§è¡Œæ–‡ä»¶
â”œâ”€â”€ assets/                # èµ„æºæ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ sounds/
â”‚   â””â”€â”€ icons/
â”œâ”€â”€ config.ini             # é…ç½®æ–‡ä»¶
â”œâ”€â”€ data/                  # æ•°æ®ç›®å½•ï¼ˆç©ºï¼‰
â”œâ”€â”€ README.txt             # ä½¿ç”¨è¯´æ˜
â””â”€â”€ LICENSE.txt            # è®¸å¯è¯
```

---

## âœ… æ‰“åŒ…æ£€æŸ¥æ¸…å•

æ‰“åŒ…å‰æ£€æŸ¥ï¼š
- [ ] æ‰€æœ‰ä¾èµ–å·²å®‰è£…
- [ ] èµ„æºæ–‡ä»¶å·²å‡†å¤‡
- [ ] é…ç½®æ–‡ä»¶å·²æ›´æ–°
- [ ] ä»£ç å·²æµ‹è¯•æ— è¯¯
- [ ] å›¾æ ‡æ–‡ä»¶å­˜åœ¨

æ‰“åŒ…åæ£€æŸ¥ï¼š
- [ ] exe æ–‡ä»¶èƒ½æ­£å¸¸è¿è¡Œ
- [ ] èµ„æºæ–‡ä»¶åŠ è½½æ­£å¸¸
- [ ] æ•°æ®åº“åˆ›å»ºæˆåŠŸ
- [ ] ç³»ç»Ÿæ‰˜ç›˜æ˜¾ç¤ºæ­£å¸¸
- [ ] æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡

---

*æ–‡æ¡£ç‰ˆæœ¬: v1.0*  
*æœ€åæ›´æ–°: 2025-01-13*  
*ç»´æŠ¤è€…: Desktop Pet Development Team*

