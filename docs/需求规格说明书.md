# 桌面灵宠 - 需求规格说明书 (SRS)

**文档版本**: v1.1  
**当前版本**: v0.5.0 敬业签增强版  
**更新日期**: 2025-01-13  
**文档类型**: 软件需求规格说明书

---

## 1. 项目概述

### 1.1 项目名称
桌面灵宠（Desktop Pet Assistant）

### 1.2 项目简介
开发一款集互动娱乐与日程管理于一体的桌面宠物应用。宠物可以在桌面上自由活动，与用户进行互动，同时具备待办事项管理和智能提醒功能，帮助用户提高工作效率。

### 1.3 产品定位
桌面灵宠是一款集**任务管理**、**时间管理**、**AI陪伴**和**游戏化成长**于一体的智能桌面助手应用。通过可爱的宠物形象和RPG元素，让用户在高效完成工作的同时，获得有趣的养成体验。

### 1.4 目标用户
- 需要任务管理工具的上班族和学生
- 喜欢桌面宠物的用户
- 希望以轻松有趣的方式管理日程的用户

### 1.5 开发语言与平台
- **开发语言**: Python 3.8+
- **目标平台**: Windows（主要）、可扩展至 macOS 和 Linux

---

## 2. 功能需求

### 2.1 核心功能（v0.1.0 MVP）

#### 2.1.1 桌面宠物系统
- 透明窗口显示，无边框，始终置顶
- 宠物形象支持PNG序列帧或GIF动画
- 自适应屏幕分辨率，防止宠物超出屏幕范围
- 拖拽移动：用户可以用鼠标拖动宠物到桌面任意位置
- 点击互动：单击、双击、右键菜单
- 动画状态：idle（待机）、walk（行走）、sleep（睡觉）、happy（开心）、alert（警告/提醒）

#### 2.1.2 待办事项管理
- 添加任务：标题、描述、截止日期、优先级、分类标签
- 编辑任务：修改任务的所有属性
- 删除任务：支持单个删除和批量删除
- 任务状态：未开始、进行中、已完成、已过期
- 任务显示：列表视图、今日任务、过滤和排序、搜索功能

#### 2.1.3 提醒系统
- 定时提醒：任务到期前提醒（可设置提前时间）
- 提醒方式：宠物播放提醒动画、弹出提醒窗口、系统托盘通知、提醒音效
- 贪睡功能：延迟提醒时间

#### 2.1.4 系统功能
- 设置选项：宠物形象选择、动画速度调节、音效开关和音量控制、开机自启动
- 数据管理：本地数据持久化（SQLite数据库）、数据导入/导出、数据备份与恢复
- 系统集成：系统托盘图标、右键菜单、Windows任务栏集成

### 2.2 增强功能（v0.2.0-v0.3.0）

- 任务编辑：双击任务编辑
- 任务搜索：实时搜索功能
- 任务标签：标签系统，支持多标签
- 音效系统：点击/提醒/完成音效
- 主题切换：亮色/暗色主题
- 数据统计：任务统计图表
- 新手引导：首次启动教程

### 2.3 智能功能（v0.4.0）

#### 2.3.1 番茄钟系统
- 计时器功能：25分钟工作/5分钟短休息/15分钟长休息
- 自定义时长：可自由设置工作和休息时间
- 任务关联：番茄钟可关联具体任务
- 桌面小组件：悬浮计时器，可拖动位置
- 专注模式：屏蔽通知，专心工作
- 统计报表：查看番茄钟完成情况和工作时长

#### 2.3.2 宠物成长系统
- 经验值系统：完成任务+5经验，番茄钟+3经验
- 等级系统：每100经验升1级，无上限
- 4维属性：饱食度、心情、健康、能量
- 进化系统：10级/25级/50级三次进化
- 属性衰减：每小时自动衰减5点
- 互动系统：喂食、玩耍、休息恢复属性

#### 2.3.3 成就系统
- 30+成就：覆盖等级、任务、番茄钟、互动等
- 成就墙：精美的成就展示界面
- 自动解锁：达成条件自动检测并解锁
- 成就分类：按类型分组显示
- 解锁提示：解锁时的动画和通知

#### 2.3.4 道具系统
- 14种道具：食物、玩具、药品、装备等
- 背包管理：查看和使用道具
- 道具效果：恢复属性、增加心情等
- 装备系统：可穿戴装备（项圈、帽子、围巾）
- 奖励机制：完成任务/番茄钟获得道具

#### 2.3.5 AI对话系统
- OpenAI集成：支持GPT-3.5/GPT-4模型
- 智能对话：与宠物聊天，获得建议
- 3种性格：活力四射、沉稳智慧、默认性格
- 上下文记忆：保留最近10条对话
- 对话历史：所有对话保存到数据库
- 任务建议：AI分析任务列表给出建议

#### 2.3.6 图片识别系统
- 拖放识别：将图片拖到宠物即可识别
- Vision API：OpenAI Vision API智能识别
- 自动生成任务：从图片内容生成待办事项
- 批量添加：一次识别多个任务
- 识别历史：保存识别记录到数据库

#### 2.3.7 多宠物系统
- 多宠物管理：最多拥有5只宠物
- 宠物切换：切换激活的主宠物
- 位置记忆：每只宠物独立保存位置
- 独立属性：每只宠物有独立的等级和属性
- 宠物商店：使用积分购买新宠物
- 积分系统：完成任务+10积分，番茄钟+5积分

### 2.4 敬业签功能集成（v0.5.0）✨新

#### 2.4.1 便签系统
- **富文本编辑**：支持文本格式化（粗体、斜体、下划线、颜色）
- **图片附件**：支持在便签中插入图片，支持常见格式（PNG、JPG、GIF）
- **文件附件**：支持添加文件附件，显示文件图标和名称
- **便签分类**：支持创建多个分类文件夹，便签可归属于不同分类
- **便签搜索**：全文搜索，支持搜索标题、内容和附件名称
- **便签排序**：按创建时间、修改时间、标题等排序
- **便签置顶**：重要便签可置顶显示
- **便签锁定**：防止误删的重要便签可锁定

#### 2.4.2 增强待办功能
- **子任务系统**：任务可包含多个子任务，支持子任务独立完成状态
- **任务附件**：任务可添加附件（图片、文档等）
- **任务备注**：支持富文本备注，记录任务执行过程
- **任务依赖**：支持设置任务依赖关系（前置任务）
- **任务模板**：常用任务可保存为模板，快速创建
- **批量操作**：支持批量移动、批量删除、批量修改分类

#### 2.4.3 视图系统
- **列表视图**：传统的列表展示方式（已有）
- **时间轴视图**：按时间顺序展示任务和便签，清晰展示时间线
- **日历视图**：月视图展示，直观查看每日任务分布
- **看板视图**：看板式展示，按状态分组（待办、进行中、已完成）
- **视图切换**：快速切换不同视图模式
- **视图自定义**：可自定义视图显示字段和排序方式

#### 2.4.4 增强提醒系统
- **重复提醒**：支持每日、每周、每月、每年重复提醒
- **多时间点提醒**：一个任务可设置多个提醒时间点
- **提醒模板**：常用提醒时间可保存为模板
- **提醒历史**：查看所有提醒记录和执行情况
- **提醒统计**：统计提醒响应率和完成率

#### 2.4.5 数据管理增强
- **数据导出**：支持导出为JSON、CSV、TXT格式
- **数据导入**：支持从JSON、CSV格式导入数据
- **数据同步**（计划中）：未来支持多设备云同步（当前版本仅PC端）
- **数据备份**：自动备份和手动备份功能
- **数据恢复**：从备份文件恢复数据
- **数据统计**：详细的统计报表，包括任务完成率、便签数量等

#### 2.4.6 快捷操作
- **全局快捷键**：支持全局快捷键快速创建任务/便签
- **快速输入**：支持快速输入语法（如：@分类 #标签 时间）
- **拖拽操作**：支持拖拽文件到窗口快速创建任务/便签
- **右键菜单**：丰富的右键菜单，快速操作
- **命令面板**：类似VS Code的命令面板，快速执行操作

---

## 3. 非功能需求

### 3.1 性能需求
- CPU占用率 < 2%（闲置状态）
- 内存占用 < 100MB
- 启动时间 < 3秒
- 界面响应时间 < 100ms

### 3.2 可靠性需求
- 数据操作无丢失
- 提醒准确率100%
- 异常处理和错误恢复

### 3.3 可用性需求
- 界面友好，操作直观
- 动画流畅自然
- 无明显Bug和崩溃
- 支持亮色/暗色主题

### 3.4 兼容性需求
- Windows 10/11（主要支持）
- 可扩展至 macOS 和 Linux
- Python 3.8+

---

## 4. 技术方案

### 4.1 技术栈选择

| 技术类别 | 推荐方案 | 说明 |
|---------|---------|------|
| GUI框架 | PyQt5 | 成熟稳定，社区资源丰富 |
| 数据库 | SQLite3 | 轻量级，无需额外安装 |
| 动画处理 | QMovie (GIF) | 方便制作和替换 |
| 系统托盘 | QSystemTrayIcon | PyQt5内置组件 |
| 定时任务 | QTimer | 与PyQt事件循环集成良好 |
| 配置管理 | configparser | Python标准库 |
| AI支持 | OpenAI API | GPT和Vision API |

### 4.2 数据库设计

**核心表（20个）**：
1. `tasks` - 任务表
2. `config` - 配置表
3. `tags` - 标签表
4. `task_tags` - 任务标签关联表
5. `pomodoro_sessions` - 番茄钟会话表
6. `pets` - 宠物表
7. `achievements` - 成就表
8. `inventory` - 背包表
9. `chat_history` - 对话历史表
10. `image_tasks` - 图片识别记录表
11. `notes` - 便签表 [v0.5.0]
12. `note_categories` - 便签分类表 [v0.5.0]
13. `attachments` - 附件表 [v0.5.0]
14. `subtasks` - 子任务表 [v0.5.0]
15. `task_dependencies` - 任务依赖表 [v0.5.0]
16. `task_templates` - 任务模板表 [v0.5.0]
17. `reminder_history` - 提醒历史表 [v0.5.0]
18. `reminder_templates` - 提醒模板表 [v0.5.0]
19. `view_settings` - 视图设置表 [v0.5.0]
20. `backup_records` - 备份记录表 [v0.5.0]

---

## 5. 用户故事

### 基础场景
1. 作为用户，我想添加一个待办事项，以便记住要做的事
2. 作为用户，我想设置任务提醒，以便不会忘记
3. 作为用户，我想完成任务时获得奖励，以便有动力继续

### 高级场景
4. 作为用户，我想使用番茄钟专注工作，提升效率
5. 作为用户，我想和宠物对话，获得陪伴感
6. 作为用户，我想拖放图片生成任务，快速记录待办
7. 作为用户，我想看到宠物成长，有养成乐趣
8. 作为用户，我想解锁成就，获得成就感

### 敬业签场景（v0.5.0）
9. 作为用户，我想创建便签记录想法，支持富文本和图片
10. 作为用户，我想在日历视图中查看任务分布，方便规划时间
11. 作为用户，我想设置重复提醒，避免忘记周期性任务
12. 作为用户，我想创建子任务，将复杂任务分解为小步骤
13. 作为用户，我想使用全局快捷键快速创建任务，提高效率
14. 作为用户，我想导出数据备份，确保数据安全

---

## 6. 验收标准

### MVP验收（v0.1.0）
- ✅ 宠物可以显示和拖动
- ✅ 可以添加、编辑、删除、完成任务
- ✅ 任务到时间会弹窗提醒
- ✅ 数据可以持久化保存
- ✅ 系统托盘功能正常

### 完整版验收（v0.4.0）
- ✅ 所有基础功能正常
- ✅ 番茄钟可以正常计时和统计
- ✅ AI对话流畅，回复合理
- ✅ 图片识别准确，任务生成正确
- ✅ 宠物成长系统完整，属性正常变化
- ✅ 成就可以正常解锁
- ✅ 道具可以正常使用
- ✅ 商店可以正常购买
- ✅ 多宠物切换正常

### 敬业签版验收（v0.5.0）
- ⏳ 便签功能完整，支持富文本和附件
- ⏳ 时间轴视图和日历视图正常显示
- ⏳ 重复提醒功能正常工作
- ⏳ 子任务系统完整，支持嵌套
- ⏳ 全局快捷键响应正常
- ⏳ 数据导入导出功能正常
- ⏳ 视图切换流畅，无卡顿

---

*文档版本: v1.1*  
*最后更新: 2025-01-13*  
*维护者: Desktop Pet Development Team*  
*更新说明: 新增v0.5.0敬业签功能集成需求*

